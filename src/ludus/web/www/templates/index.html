<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Ludus main page">
    <meta name="author" content="Oliver Dashiell Bunyan">
    <link rel="shortcut icon" href="{{ static_url('images/favicon.png') }}">

	<title>Ludus</title>

	{% if debug == True %}
		<link type="text/css" rel="stylesheet" href="{{ static_url('css/ludus-debug.css') }}">
	{% else %}
		<link type="text/css" rel="stylesheet" href="{{ static_url('css/ludus.css') }}">
	{% end %}
</head>
<body>
	<noscript>Ludus requires JavaScript (you seem to have it turned off...)</noscript>

	<div class="navbar navbar-inverse navbar-static-top" role="navigation">
		<div class="container-fluid navbar-container">
			<div class="navbar-header">
				<a class="navbar-brand" href="#">
					<img src="{{ static_url('images/favicon_orange.png') }}" class="img-responsive icon">
					LUDUS
				</a>

				<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
					<span class="sr-only">Toggle navigation</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
			</div>

			<div class="collapse navbar-collapse">
				<p class="navbar-text navbar-right">
				  	<span data-bind="css:{connect: $root.ws.status_() == 'connected', 
				  						  reconnect: $root.ws.status_() == 'connecting', 
				  						  disconnect: $root.ws.status_() != 'connected'}">

				    <i class="fa" data-bind="css:{'fa-circle-o': $root.ws.status_() == 'connected',
				    							  'fa-dot-circle-o': $root.ws.status_() == 'connecting',
				    							  'fa-circle': $root.ws.status_() != 'connected'}"></i>
				    <!-- ko if: ws.status_() == 'connecting' -->
				    	<!-- <span class="connect-text" data-bind="text: ws.status"></span> -->
				    <!-- /ko -->
				    </span>
				</p>

				<ul class="nav navbar-nav navbar-right">
					<li class="dropdown">
						<a href="#" class="dropdown-toggle" data-toggle="dropdown">
							<span data-bind="text:settings.user.name"></span> <b class="caret"></b>
						</a>

						<ul class="dropdown-menu">
							<li><a href="#account" data-bind="click:$.proxy(view_account, $data)">My Account</a></li>
							<li class="divider"></li>
							<li><a href="/logout">Logout</a></li>
						</ul>
			        </li>
		        </ul>

				<ul class="nav navbar-nav">
					<li data-bind="css:{active:games_panel == panel()}">
						<a href="#mygames" data-bind="click:$.proxy(view_games, $data), clickBubble:false">My Games</a>
					</li>
					<li data-bind="css:{active:about_panel == panel()}">
						<a href="#about" data-bind="click:$.proxy(about, $data), clickBubble:false">About</a>
					</li>
				</ul>
			</div><!--/.nav-collapse -->
		</div>
    </div>

	<div class="container-fluid">
		<!-- ko template:{name:panel().template} -->
		<!-- /ko -->
    </div><!-- /.container -->


    <!-- DELETE GAME MODAL -->
    <div id="delete_game_dlog" class="modal fade">
    	<div class="modal-dialog modal-sm">
    		<div class="modal-content">
    			<div class="modal-header modal-header-custom">
    				<button type="button" class="close modal-close" data-dismiss="modal" aria-hidden="true">&times;</button>
    				<h4 class="modal-title">Delete <span id="delete_game_name"></span></h4>
    			</div>
    			<div class="modal-body modal-body-custom">
    				<p> Are you sure you want to delete this game and all its resources? </p>
    				<br>
    				<p> <strong style="color:#d9534f;">Warning:</strong> This action cannot be undone. </p>
    			</div>
    			<div class="modal-footer modal-footer-custom">
    				<button type="button" class="btn btn-default btn-custom" data-dismiss="modal">Cancel</button>
    				<button id="delete_game_button" type="button" class="btn btn-default btn-custom btn-custom-danger">
    					<i class="fa fa-trash-o icon"></i>
    					Delete
    				</button>
    			</div>
    		</div><!-- /.modal-content -->
    	</div><!-- /.modal-dialog -->
    </div><!-- /.modal -->

    <!-- KICKED MODAL -->
    <div id="kicked_dlog" class="modal fade">
    	<div class="modal-dialog modal-sm">
    		<div class="modal-content">
    			<div class="modal-header modal-header-custom">
    				<button type="button" class="close modal-close" data-dismiss="modal" aria-hidden="true">&times;</button>
    				<h4 class="modal-title">Kicked <span id="delete_game_name"></span></h4>
    			</div>
    			<div class="modal-body modal-body-custom">
    				<strong style="color:#d9534f;">Ruh Roh!</strong>
    				<br>
    				<p> Looks like you just got kicked from the game. You wont be able to access this game anymore. </p>
    			</div>
    			<div class="modal-footer modal-footer-custom">
    				<button type="button" class="btn btn-default btn-custom" data-dismiss="modal">Ok</button>
    			</div>
    		</div><!-- /.modal-content -->
    	</div><!-- /.modal-dialog -->
    </div><!-- /.modal -->

    <!-- STOP BUILD MODAL -->
    <div id="stop_build_dlog" class="modal fade">
    	<div class="modal-dialog modal-sm">
    		<div class="modal-content">
    			<div class="modal-header modal-header-custom">
    				<button type="button" class="close modal-close" data-dismiss="modal" aria-hidden="true">&times;</button>
    				<h4 class="modal-title">No Longer a Builder <span id="delete_game_name"></span></h4>
    			</div>
    			<div class="modal-body modal-body-custom">
    				<strong style="color:#d9534f;">Ruh Roh!</strong>
    				<br>
    				<p> Mr Admin just revoked your rights. You can't edit this game anymore but don't worry you can still play the game. </p>
    			</div>
    			<div class="modal-footer modal-footer-custom">
    				<button type="button" class="btn btn-default btn-custom" data-dismiss="modal">Ok</button>
    			</div>
    		</div><!-- /.modal-content -->
    	</div><!-- /.modal-dialog -->
    </div><!-- /.modal -->


	<div class='notifications top-right'></div>
	<div class='notifications bottom-right'></div>
	<div class='notifications top-left'></div>
	<div class='notifications bottom-left'></div>

    {% include 'panels/_include_.html' %}

	{% if debug == True %}
		<script type="text/javascript" src="{{ static_url('lib/bower_components/requirejs/require.js') }}"></script>
		<script type="text/javascript" src="{{ static_url('js/main-debug.js') }}"></script>
	{% else %}
		<script type="text/javascript" src="{{ static_url('lib/bower_components/requirejs/require.js') }}"></script>
		<script type="text/javascript" src="{{ static_url('js/main.js') }}"></script>
	{% end %}
	
	<script type="text/javascript">
		require(["knockout","main","bootstrap"],
			function(ko, appl){

				appl.settings.ws_url = "{{ws_url}}";
				appl.settings.user = {% raw user_json %};
				
				{% if debug == True %}
					appl.debug(true);
				{% end %}

				appl.connect();
				ko.applyBindings(appl);
			}
		);
	</script>
</body>
</html>